<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />


<meta name="author" content="Ma Adelle Gia Arbo" />

<meta name="date" content="2022-10-14" />

<title>Text as Data Problem Set 1</title>

<script src="text_as_data_ps1_files/header-attrs-2.13/header-attrs.js"></script>
<script src="text_as_data_ps1_files/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="text_as_data_ps1_files/bootstrap-3.3.5/css/lumen.min.css" rel="stylesheet" />
<script src="text_as_data_ps1_files/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="text_as_data_ps1_files/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="text_as_data_ps1_files/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="text_as_data_ps1_files/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="text_as_data_ps1_files/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="text_as_data_ps1_files/tocify-1.9.1/jquery.tocify.js"></script>
<script src="text_as_data_ps1_files/navigation-1.1/tabsets.js"></script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>



<style type="text/css">
  code {
    white-space: pre;
  }
  .sourceCode {
    overflow: visible;
  }
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  background-color: #f8f8f8; }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ef2929; } /* Alert */
code span.an { color: #8f5902; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #c4a000; } /* Attribute */
code span.bn { color: #0000cf; } /* BaseN */
code span.cf { color: #204a87; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4e9a06; } /* Char */
code span.cn { color: #000000; } /* Constant */
code span.co { color: #8f5902; font-style: italic; } /* Comment */
code span.cv { color: #8f5902; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #8f5902; font-weight: bold; font-style: italic; } /* Documentation */
code span.dt { color: #204a87; } /* DataType */
code span.dv { color: #0000cf; } /* DecVal */
code span.er { color: #a40000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #0000cf; } /* Float */
code span.fu { color: #000000; } /* Function */
code span.im { } /* Import */
code span.in { color: #8f5902; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #204a87; font-weight: bold; } /* Keyword */
code span.op { color: #ce5c00; font-weight: bold; } /* Operator */
code span.ot { color: #8f5902; } /* Other */
code span.pp { color: #8f5902; font-style: italic; } /* Preprocessor */
code span.sc { color: #000000; } /* SpecialChar */
code span.ss { color: #4e9a06; } /* SpecialString */
code span.st { color: #4e9a06; } /* String */
code span.va { color: #000000; } /* Variable */
code span.vs { color: #4e9a06; } /* VerbatimString */
code span.wa { color: #8f5902; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<link rel="stylesheet" href="custom.css" type="text/css" />



<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>



<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div id="header">



<h1 class="title toc-ignore">Text as Data Problem Set 1</h1>
<h4 class="author">Ma Adelle Gia Arbo</h4>
<h4 class="date">14 October 2022</h4>

</div>


<style>
div.answer {background-color:#f3f0ff; border-radius: 5px; padding: 20px;}
</style>
<p><br></p>
<hr />
<div id="i.-getting-and-parsing-texts" class="section level1">
<h1>I. Getting and parsing texts</h1>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># loading packages</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">require</span>(<span class="st">&quot;pacman&quot;</span>)) <span class="fu">install.packages</span>(<span class="st">&quot;pacman&quot;</span>)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>pacman<span class="sc">::</span><span class="fu">p_load</span>(quanteda, tidyr, purrr, ggplot2, </span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>               tidytext, httr, rvest, readr, xml2, reshape2,</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>               stringr, stringi, dplyr, tibble, lexicon)</span></code></pre></div>
<p>First, let’s read the text file <em>pg1934.txt</em> containing the
collection of poems <em>Songs of Innocence and of Experience</em> by
William Blake from Project Gutenberg. To make parsing easier in the next
steps, I already split the text file wherein one line is one element of
the list, <em>pg1934</em>.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> readr<span class="sc">::</span><span class="fu">read_file</span>(<span class="st">&quot;./data/raw/pg1934.txt&quot;</span>) </span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>pg1934 <span class="ot">&lt;-</span> <span class="fu">str_split</span>(p, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)[[<span class="dv">1</span>]]</span></code></pre></div>
<p>Next, from the list that I created above, I obtained the table of
contents to get a list of titles of the 47 poems, 19 of which are from
the Songs of Innocence and 28 are from the Songs of Experience .</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># table of contents</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>soi_lines <span class="ot">&lt;-</span> <span class="fu">str_which</span>(pg1934, <span class="at">pattern =</span> <span class="fu">fixed</span>(<span class="st">&quot;SONGS OF INNOCENCE&quot;</span>))</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>soe_lines <span class="ot">&lt;-</span> <span class="fu">str_which</span>(pg1934, <span class="at">pattern =</span> <span class="fu">fixed</span>(<span class="st">&quot;SONGS OF EXPERIENCE&quot;</span>))</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>toc_soi <span class="ot">&lt;-</span> pg1934[(soi_lines[<span class="dv">3</span>]<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>(soe_lines[<span class="dv">1</span>]<span class="sc">-</span><span class="dv">1</span>)] <span class="sc">%&gt;%</span></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>            <span class="fu">str_subset</span>(<span class="st">&quot;.+&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>            <span class="fu">str_trim</span>()</span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>toc_soe <span class="ot">&lt;-</span> pg1934[(soe_lines[<span class="dv">1</span>]<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>(soi_lines[<span class="dv">4</span>]<span class="sc">-</span><span class="dv">1</span>)] <span class="sc">%&gt;%</span></span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>            <span class="fu">str_subset</span>(<span class="st">&quot;.+&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>            <span class="fu">str_trim</span>() <span class="sc">%&gt;%</span></span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a>            <span class="fu">str_replace</span>(<span class="st">&quot;My Pretty Rose-Tree&quot;</span>, <span class="st">&quot;My Pretty Rose Tree&quot;</span>)</span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a>toc <span class="ot">&lt;-</span> <span class="fu">append</span>(toc_soi, toc_soe)</span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a>toc</span></code></pre></div>
<pre><code> [1] &quot;Introduction&quot;                  &quot;The Shepherd&quot;                 
 [3] &quot;The Echoing Green&quot;             &quot;The Lamb&quot;                     
 [5] &quot;The Little Black Boy&quot;          &quot;The Blossom&quot;                  
 [7] &quot;The Chimney-Sweeper&quot;           &quot;The Little Boy Lost&quot;          
 [9] &quot;The Little Boy Found&quot;          &quot;Laughing Song&quot;                
[11] &quot;A Cradle Song&quot;                 &quot;The Divine Image&quot;             
[13] &quot;Holy Thursday&quot;                 &quot;Night&quot;                        
[15] &quot;Spring&quot;                        &quot;Nurse’s Song&quot;                 
[17] &quot;Infant Joy&quot;                    &quot;A Dream&quot;                      
[19] &quot;On Another’s Sorrow&quot;           &quot;Introduction&quot;                 
[21] &quot;Earth’s Answer&quot;                &quot;The Clod and the Pebble&quot;      
[23] &quot;Holy Thursday&quot;                 &quot;The Little Girl Lost&quot;         
[25] &quot;The Little Girl Found&quot;         &quot;The Chimney-Sweeper&quot;          
[27] &quot;Nurse’s Song&quot;                  &quot;The Sick Rose&quot;                
[29] &quot;The Fly&quot;                       &quot;The Angel&quot;                    
[31] &quot;The Tiger&quot;                     &quot;My Pretty Rose Tree&quot;          
[33] &quot;Ah, Sunflower&quot;                 &quot;The Lily&quot;                     
[35] &quot;The Garden of Love&quot;            &quot;The Little Vagabond&quot;          
[37] &quot;London&quot;                        &quot;The Human Abstract&quot;           
[39] &quot;Infant Sorrow&quot;                 &quot;A Poison Tree&quot;                
[41] &quot;A Little Boy Lost&quot;             &quot;A Little Girl Lost&quot;           
[43] &quot;A Divine Image&quot;                &quot;A Cradle Song&quot;                
[45] &quot;To Tirzah&quot;                     &quot;The Schoolboy&quot;                
[47] &quot;The Voice of the Ancient Bard&quot;</code></pre>
<p>For this part, I extracted the main body of the file containing all
of the 47 poems.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># main body</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>start <span class="ot">&lt;-</span> soi_lines[<span class="dv">4</span>]</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>end <span class="ot">&lt;-</span>  <span class="fu">str_which</span>(pg1934, <span class="at">pattern =</span> <span class="fu">fixed</span>(<span class="st">&quot;*** END OF THE PROJECT GUTENBERG EBOOK SONGS OF INNOCENCE AND OF EXPERIENCE ***&quot;</span>))</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>body <span class="ot">&lt;-</span> pg1934[(start)<span class="sc">:</span>(end<span class="dv">-1</span>)] <span class="co">#%&gt;%</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>          <span class="co">#stri_remove_empty() %&gt;%</span></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>          <span class="co">#str_subset(&quot;.+&quot;) %&gt;%</span></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>          <span class="do">##str_trim()</span></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>body <span class="ot">&lt;-</span> <span class="fu">append</span>(body, <span class="st">&quot;&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>        <span class="fu">str_replace</span>(<span class="st">&quot;SONGS OF EXPERIENCE&quot;</span>, <span class="st">&quot;&quot;</span>) </span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(body, <span class="dv">33</span>)</span></code></pre></div>
<pre><code> [1] &quot;SONGS OF INNOCENCE\r&quot;                 
 [2] &quot;\r&quot;                                   
 [3] &quot;\r&quot;                                   
 [4] &quot;\r&quot;                                   
 [5] &quot;\r&quot;                                   
 [6] &quot;INTRODUCTION\r&quot;                       
 [7] &quot;\r&quot;                                   
 [8] &quot;\r&quot;                                   
 [9] &quot;Piping down the valleys wild,\r&quot;      
[10] &quot;    Piping songs of pleasant glee,\r&quot; 
[11] &quot;On a cloud I saw a child,\r&quot;          
[12] &quot;    And he laughing said to me:\r&quot;    
[13] &quot;\r&quot;                                   
[14] &quot;‘Pipe a song about a Lamb!’\r&quot;        
[15] &quot;    So I piped with merry cheer.\r&quot;   
[16] &quot;‘Piper, pipe that song again.’\r&quot;     
[17] &quot;    So I piped: he wept to hear.\r&quot;   
[18] &quot;\r&quot;                                   
[19] &quot;‘Drop thy pipe, thy happy pipe;\r&quot;    
[20] &quot;    Sing thy songs of happy cheer!’\r&quot;
[21] &quot;So I sung the same again,\r&quot;          
[22] &quot;    While he wept with joy to hear.\r&quot;
[23] &quot;\r&quot;                                   
[24] &quot;‘Piper, sit thee down and write\r&quot;    
[25] &quot;    In a book, that all may read.’\r&quot; 
[26] &quot;So he vanished from my sight;\r&quot;      
[27] &quot;    And I plucked a hollow reed,\r&quot;   
[28] &quot;\r&quot;                                   
[29] &quot;And I made a rural pen,\r&quot;            
[30] &quot;    And I stained the water clear,\r&quot; 
[31] &quot;And I wrote my happy songs\r&quot;         
[32] &quot;    Every child may joy to hear.\r&quot;   
[33] &quot;\r&quot;                                   </code></pre>
<p>Using the main body, I retrieved for the indices where the titles in
the tables of contents appear in the body.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># index of poem titles</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>index <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(toc)) {</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>  index[[i]] <span class="ot">&lt;-</span> <span class="fu">str_which</span>(body, <span class="at">pattern =</span> <span class="fu">toupper</span>(toc[i]))</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>index<span class="ot">&lt;-</span> <span class="fu">unlist</span>(index) <span class="sc">%&gt;%</span> </span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>        <span class="fu">unique</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>        <span class="fu">sort</span>(<span class="at">decreasing =</span> F)</span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>index <span class="ot">&lt;-</span> <span class="fu">append</span>(index, <span class="fu">length</span>(body))</span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a>index</span></code></pre></div>
<pre><code> [1]    6   37   53   92  121  162  182  218  234  250  271  317  348  369  429
[16]  465  491  511  542  598  628  664  685  711  782  853  874  890  906  937
[31]  963  999 1015 1031 1042 1063 1089 1115 1151 1167 1193 1229 1276 1292 1318
[46] 1344 1386 1404</code></pre>
<p>With the list of indices, I can now locate the start and end of each
of the 47 poems using a specific pattern, as seen in the code below.
Then, I saved each poem and appended it into a list.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co"># extract each poem</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>poems <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(toc)) {</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>  poems[[i]] <span class="ot">&lt;-</span> body[((index[i]<span class="sc">+</span><span class="dv">3</span>)<span class="sc">:</span>(index[i<span class="sc">+</span><span class="dv">1</span>]<span class="sc">-</span><span class="dv">5</span>))]</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(poems, <span class="dv">1</span>)</span></code></pre></div>
<pre><code>[[1]]
 [1] &quot;Piping down the valleys wild,\r&quot;      
 [2] &quot;    Piping songs of pleasant glee,\r&quot; 
 [3] &quot;On a cloud I saw a child,\r&quot;          
 [4] &quot;    And he laughing said to me:\r&quot;    
 [5] &quot;\r&quot;                                   
 [6] &quot;‘Pipe a song about a Lamb!’\r&quot;        
 [7] &quot;    So I piped with merry cheer.\r&quot;   
 [8] &quot;‘Piper, pipe that song again.’\r&quot;     
 [9] &quot;    So I piped: he wept to hear.\r&quot;   
[10] &quot;\r&quot;                                   
[11] &quot;‘Drop thy pipe, thy happy pipe;\r&quot;    
[12] &quot;    Sing thy songs of happy cheer!’\r&quot;
[13] &quot;So I sung the same again,\r&quot;          
[14] &quot;    While he wept with joy to hear.\r&quot;
[15] &quot;\r&quot;                                   
[16] &quot;‘Piper, sit thee down and write\r&quot;    
[17] &quot;    In a book, that all may read.’\r&quot; 
[18] &quot;So he vanished from my sight;\r&quot;      
[19] &quot;    And I plucked a hollow reed,\r&quot;   
[20] &quot;\r&quot;                                   
[21] &quot;And I made a rural pen,\r&quot;            
[22] &quot;    And I stained the water clear,\r&quot; 
[23] &quot;And I wrote my happy songs\r&quot;         
[24] &quot;    Every child may joy to hear.\r&quot;   </code></pre>
<p>Now that I have a list of poems, wherein each poem consists a of list
of its lines, I can split this further into stanzas by joining the all
lines of the poem then splitting it based on a specific pattern, as
coded below.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co"># extract stanzas of each poem</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>stanzas <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(poems)) {</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>  stanza<span class="ot">=</span><span class="fu">str_c</span>(poems[[i]], <span class="at">collapse=</span><span class="st">&quot;</span><span class="sc">\r</span><span class="st">&quot;</span>)</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>  stanzas[i] <span class="ot">=</span> <span class="fu">str_split</span>(stanza, <span class="st">&quot;</span><span class="sc">\r\r\r\r</span><span class="st">&quot;</span>)</span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(stanzas, <span class="dv">2</span>)</span></code></pre></div>
<pre><code>[[1]]
[1] &quot;Piping down the valleys wild,\r\r    Piping songs of pleasant glee,\r\rOn a cloud I saw a child,\r\r    And he laughing said to me:&quot;       
[2] &quot;‘Pipe a song about a Lamb!’\r\r    So I piped with merry cheer.\r\r‘Piper, pipe that song again.’\r\r    So I piped: he wept to hear.&quot;     
[3] &quot;‘Drop thy pipe, thy happy pipe;\r\r    Sing thy songs of happy cheer!’\r\rSo I sung the same again,\r\r    While he wept with joy to hear.&quot;
[4] &quot;‘Piper, sit thee down and write\r\r    In a book, that all may read.’\r\rSo he vanished from my sight;\r\r    And I plucked a hollow reed,&quot;
[5] &quot;And I made a rural pen,\r\r    And I stained the water clear,\r\rAnd I wrote my happy songs\r\r    Every child may joy to hear.\r&quot;         

[[2]]
[1] &quot;How sweet is the shepherd’s sweet lot!\r\rFrom the morn to the evening he strays;\r\rHe shall follow his sheep all the day,\r\rAnd his tongue shall be fillèd with praise.&quot;
[2] &quot;For he hears the lambs’ innocent call,\r\rAnd he hears the ewes’ tender reply;\r\rHe is watchful while they are in peace,\r\rFor they know when their shepherd is nigh.\r&quot; </code></pre>
<p>I tidied the list of table of contents into a dataframe (toc_df) and
created columns book_title, poem_title, and the poem id that is
poem_number. I also tidied the list of stanzas into a dataframe
(stanzas_df) from which I can extract the lines of each stanza per poem.
In this way, I can create a dataframe with rows as lines of each poem,
and it is easier to create the stanza number of each poem using
group_by.</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co"># convert toc list to df</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>toc_df <span class="ot">&lt;-</span> <span class="fu">enframe</span>(toc) <span class="sc">%&gt;%</span></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>          <span class="fu">mutate</span>(<span class="at">book_title =</span> <span class="fu">ifelse</span>(name<span class="sc">&lt;=</span><span class="dv">19</span>, <span class="st">&quot;Songs of Innocence&quot;</span>, <span class="st">&quot;Songs of Experience&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>          <span class="fu">rename</span>(<span class="at">poem_title =</span> value, <span class="at">poem_number =</span> name)</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a><span class="co"># convert stanzas list to df</span></span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>stanzas_df <span class="ot">&lt;-</span> <span class="fu">enframe</span>(stanzas) <span class="sc">%&gt;%</span></span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>              <span class="fu">rename</span>(<span class="at">stanza =</span> value) <span class="sc">%&gt;%</span></span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a>              <span class="fu">unnest</span>(stanza) <span class="sc">%&gt;%</span> </span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a>              <span class="fu">rename</span>(<span class="at">poem_number=</span>name)</span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a><span class="co"># extract lines per stanza</span></span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a>lines_df <span class="ot">&lt;-</span> stanzas_df <span class="sc">%&gt;%</span></span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true" tabindex="-1"></a>              <span class="fu">mutate</span>(<span class="at">id =</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(stanzas_df)) <span class="sc">%&gt;%</span></span>
<span id="cb13-15"><a href="#cb13-15" aria-hidden="true" tabindex="-1"></a>              <span class="fu">group_by</span>(poem_number) <span class="sc">%&gt;%</span></span>
<span id="cb13-16"><a href="#cb13-16" aria-hidden="true" tabindex="-1"></a>              <span class="fu">mutate</span>(<span class="at">stanza_number =</span> <span class="fu">row_number</span>(id)) <span class="sc">%&gt;%</span></span>
<span id="cb13-17"><a href="#cb13-17" aria-hidden="true" tabindex="-1"></a>              <span class="fu">mutate</span>(<span class="at">line =</span> <span class="fu">str_split</span>(stanza, <span class="st">&quot;</span><span class="sc">\r\r</span><span class="st">&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb13-18"><a href="#cb13-18" aria-hidden="true" tabindex="-1"></a>              <span class="fu">unnest</span>(line) <span class="sc">%&gt;%</span></span>
<span id="cb13-19"><a href="#cb13-19" aria-hidden="true" tabindex="-1"></a>              <span class="fu">subset</span>(<span class="sc">!</span>line <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;</span><span class="sc">\r</span><span class="st">&quot;</span>,<span class="st">&quot;</span><span class="sc">\r\r</span><span class="st">&quot;</span>, <span class="st">&quot;&quot;</span>))</span></code></pre></div>
<p>Finally, I merged toc_df and lines_df to create the clean dataset
with columns:</p>
<ul>
<li>poem_number</li>
<li>poem_title</li>
<li>stanza_number</li>
<li>line</li>
<li>line_number</li>
</ul>
<p>I also saved the final dataframe into a csv format.</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co"># merge data</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">merge</span>(toc_df, lines_df, <span class="at">by =</span> <span class="st">&quot;poem_number&quot;</span>) </span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>df<span class="sc">$</span>line <span class="ot">&lt;-</span> <span class="fu">str_trim</span>(df<span class="sc">$</span>line)</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>df<span class="sc">$</span>idl <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(lines_df)</span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span></span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(poem_number) <span class="sc">%&gt;%</span></span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">line_number =</span> <span class="fu">row_number</span>(idl)) <span class="sc">%&gt;%</span></span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span><span class="fu">c</span>(stanza,id,idl))</span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true" tabindex="-1"></a><span class="co"># save dataset</span></span>
<span id="cb14-13"><a href="#cb14-13" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(df, <span class="st">&quot;./data/tidy/Songs_of_Innocence_Experience.csv&quot;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(df, <span class="dv">10</span>)</span></code></pre></div>
<div class="kable-table">
<table>
<colgroup>
<col width="11%" />
<col width="12%" />
<col width="18%" />
<col width="13%" />
<col width="31%" />
<col width="11%" />
</colgroup>
<thead>
<tr class="header">
<th align="right">poem_number</th>
<th align="left">poem_title</th>
<th align="left">book_title</th>
<th align="right">stanza_number</th>
<th align="left">line</th>
<th align="right">line_number</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">1</td>
<td align="left">Introduction</td>
<td align="left">Songs of Innocence</td>
<td align="right">1</td>
<td align="left">Piping down the valleys wild,</td>
<td align="right">1</td>
</tr>
<tr class="even">
<td align="right">1</td>
<td align="left">Introduction</td>
<td align="left">Songs of Innocence</td>
<td align="right">1</td>
<td align="left">Piping songs of pleasant glee,</td>
<td align="right">2</td>
</tr>
<tr class="odd">
<td align="right">1</td>
<td align="left">Introduction</td>
<td align="left">Songs of Innocence</td>
<td align="right">1</td>
<td align="left">On a cloud I saw a child,</td>
<td align="right">3</td>
</tr>
<tr class="even">
<td align="right">1</td>
<td align="left">Introduction</td>
<td align="left">Songs of Innocence</td>
<td align="right">1</td>
<td align="left">And he laughing said to me:</td>
<td align="right">4</td>
</tr>
<tr class="odd">
<td align="right">1</td>
<td align="left">Introduction</td>
<td align="left">Songs of Innocence</td>
<td align="right">2</td>
<td align="left">‘Pipe a song about a Lamb!’</td>
<td align="right">5</td>
</tr>
<tr class="even">
<td align="right">1</td>
<td align="left">Introduction</td>
<td align="left">Songs of Innocence</td>
<td align="right">2</td>
<td align="left">So I piped with merry cheer.</td>
<td align="right">6</td>
</tr>
<tr class="odd">
<td align="right">1</td>
<td align="left">Introduction</td>
<td align="left">Songs of Innocence</td>
<td align="right">2</td>
<td align="left">‘Piper, pipe that song again.’</td>
<td align="right">7</td>
</tr>
<tr class="even">
<td align="right">1</td>
<td align="left">Introduction</td>
<td align="left">Songs of Innocence</td>
<td align="right">2</td>
<td align="left">So I piped: he wept to hear.</td>
<td align="right">8</td>
</tr>
<tr class="odd">
<td align="right">1</td>
<td align="left">Introduction</td>
<td align="left">Songs of Innocence</td>
<td align="right">3</td>
<td align="left">’Drop thy pipe, thy happy pipe;</td>
<td align="right">9</td>
</tr>
<tr class="even">
<td align="right">1</td>
<td align="left">Introduction</td>
<td align="left">Songs of Innocence</td>
<td align="right">3</td>
<td align="left">Sing thy songs of happy cheer!’</td>
<td align="right">10</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="ii.-visualising-text-data" class="section level1">
<h1>II. Visualising text data</h1>
<div id="create-a-histogram-showing-the-number-of-lines-per-poem"
class="section level2">
<h2>Create a histogram showing the number of lines per poem</h2>
<p>I first summarized the data to visualize the histogram and the bar
plots.</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>df_sum <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(book_title, poem_title, poem_number) <span class="sc">%&gt;%</span></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">n =</span> <span class="fu">n</span>(), <span class="at">.groups =</span> <span class="st">&#39;drop&#39;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(n))</span></code></pre></div>
<p>Below is the histogram showing the distribution of the number of
lines across the 47 poems. It looks like most of the poems consists of
15-20 lines. I also saved all plots into a folder.</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(df_sum<span class="sc">$</span>n, <span class="at">col=</span><span class="st">&quot;gray&quot;</span>, <span class="at">main=</span><span class="st">&quot;Histogram of No. of Lines&quot;</span>, </span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab=</span><span class="st">&quot;No. of lines&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;No. of poems&quot;</span>, <span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">15</span>))</span></code></pre></div>
<p><img
src="text_as_data_ps1_files/figure-html/unnamed-chunk-9-1.png" /><!-- --></p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="fu">png</span>(<span class="st">&quot;./plots/histogram.png&quot;</span>)</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(df_sum<span class="sc">$</span>n, <span class="at">col=</span><span class="st">&quot;gray&quot;</span>, <span class="at">main=</span><span class="st">&quot;Histogram of No. of Lines&quot;</span>, </span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab=</span><span class="st">&quot;No. of lines&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;No. of poems&quot;</span>, <span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">15</span>))</span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a><span class="fu">dev.off</span>()</span></code></pre></div>
<pre><code>png 
  2 </code></pre>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>df_sum_soi<span class="ot">&lt;-</span>df_sum <span class="sc">%&gt;%</span> <span class="fu">filter</span>(book_title<span class="sc">==</span><span class="st">&quot;Songs of Innocence&quot;</span>) <span class="sc">%&gt;%</span> <span class="fu">select</span>(n)</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(df_sum_soi<span class="sc">$</span>n,<span class="at">col=</span><span class="st">&quot;gray&quot;</span>, <span class="at">main=</span><span class="st">&quot;Histogram of No. of Lines (SOI)&quot;</span>, </span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab=</span><span class="st">&quot;No. of lines&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;No. of poems&quot;</span>, <span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">15</span>))</span></code></pre></div>
<p><img
src="text_as_data_ps1_files/figure-html/unnamed-chunk-11-1.png" /><!-- --></p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>df_sum_soe<span class="ot">&lt;-</span>df_sum <span class="sc">%&gt;%</span> <span class="fu">filter</span>(book_title<span class="sc">==</span><span class="st">&quot;Songs of Experience&quot;</span>) <span class="sc">%&gt;%</span> <span class="fu">select</span>(n)</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(df_sum_soe<span class="sc">$</span>n,<span class="at">col=</span><span class="st">&quot;gray&quot;</span>, <span class="at">main=</span><span class="st">&quot;Histogram of No. of Lines (SOE)&quot;</span>, </span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab=</span><span class="st">&quot;No. of lines&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;No. of poems&quot;</span>, <span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">15</span>))</span></code></pre></div>
<p><img
src="text_as_data_ps1_files/figure-html/unnamed-chunk-12-1.png" /><!-- --></p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>df <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(book_title) <span class="sc">%&gt;%</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="fu">n</span>())</span></code></pre></div>
<div class="kable-table">
<table>
<thead>
<tr class="header">
<th align="left">book_title</th>
<th align="right">n()</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Songs of Experience</td>
<td align="right">516</td>
</tr>
<tr class="even">
<td align="left">Songs of Innocence</td>
<td align="right">393</td>
</tr>
</tbody>
</table>
</div>
<p>To further investigate this, let’s plot a bar graph showing the
number of lines per poem for each book. It is found that The Little Girl
Lost and The Little Girl Found from the Songs of Experience are the
outliers from the histogram with more than 50 lines, and Night from the
Songs of Innocence with more than 45 lines.</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>plot_soi_soe <span class="ot">&lt;-</span> df_sum <span class="sc">%&gt;%</span>  </span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span><span class="fu">reorder</span>(poem_title,n), <span class="at">y=</span>n)) <span class="sc">+</span></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">&quot;identity&quot;</span>) <span class="sc">+</span></span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>() <span class="sc">+</span></span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>book_title) <span class="sc">+</span></span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">&quot;No. of lines&quot;</span>, <span class="at">x =</span> <span class="st">&quot;Poem title&quot;</span>) <span class="sc">+</span></span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a>plot_soi_soe</span></code></pre></div>
<p><img
src="text_as_data_ps1_files/figure-html/unnamed-chunk-14-1.png" /><!-- --></p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">&quot;./plots/plot_soi_soe.png&quot;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="co"># reorder x values</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a><span class="co"># SOI</span></span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>plot_soi <span class="ot">&lt;-</span> df_sum <span class="sc">%&gt;%</span></span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(book_title <span class="sc">==</span> <span class="st">&quot;Songs of Innocence&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span><span class="fu">reorder</span>(poem_title,n), <span class="at">y=</span>n)) <span class="sc">+</span></span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">&quot;identity&quot;</span>) <span class="sc">+</span></span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>() <span class="sc">+</span></span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">&quot;No. of lines&quot;</span>, <span class="at">x =</span> <span class="st">&quot;Poem title&quot;</span>, <span class="at">title =</span> <span class="st">&quot;Songs of Innocence&quot;</span>) <span class="sc">+</span></span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span>
<span id="cb25-10"><a href="#cb25-10" aria-hidden="true" tabindex="-1"></a>plot_soi</span></code></pre></div>
<p><img
src="text_as_data_ps1_files/figure-html/unnamed-chunk-15-1.png" /><!-- --></p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">&quot;./plots/plot_soi.png&quot;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="co"># SOE</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>plot_soe <span class="ot">&lt;-</span> df_sum <span class="sc">%&gt;%</span></span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(book_title <span class="sc">==</span> <span class="st">&quot;Songs of Experience&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span><span class="fu">reorder</span>(poem_title,n), <span class="at">y=</span>n)) <span class="sc">+</span></span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">&quot;identity&quot;</span>) <span class="sc">+</span></span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>() <span class="sc">+</span></span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">&quot;No. of lines&quot;</span>, <span class="at">x =</span> <span class="st">&quot;Poem title&quot;</span>, <span class="at">title =</span> <span class="st">&quot;Songs of Experience&quot;</span>) <span class="sc">+</span></span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span>
<span id="cb27-9"><a href="#cb27-9" aria-hidden="true" tabindex="-1"></a>plot_soe</span></code></pre></div>
<p><img
src="text_as_data_ps1_files/figure-html/unnamed-chunk-16-1.png" /><!-- --></p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">&quot;./plots/plot_soe.png&quot;</span>)</span></code></pre></div>
</div>
<div
id="create-a-document-feature-matrix-dfm-treating-each-line-as-a-document"
class="section level2">
<h2>Create a document feature matrix (dfm) treating each line as a
document</h2>
<p>To create a document feature matrix treating each line as a document,
I first created a corpus using of lines. From there, I extracted each
word (one gram) of the lines as tokens, removed punctuations, and
English stopwords. This led to 1168 features from the 909 documents with
99.73% sparse rate.</p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>corp <span class="ot">&lt;-</span> <span class="fu">corpus</span>(df<span class="sc">$</span>line)</span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>dfmat_lines <span class="ot">&lt;-</span> corp <span class="sc">%&gt;%</span> <span class="fu">tokens</span>(<span class="at">remove_punc=</span><span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tokens_remove</span>(<span class="at">pattern=</span><span class="fu">stopwords</span>(<span class="st">&quot;en&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">dfm</span>()</span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a><span class="co"># %&gt;%  dfm_trim(min_termfreq=20)</span></span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a><span class="co">#  %&gt;% dfm_tfidf() # we can also get the tfidf instead of count</span></span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true" tabindex="-1"></a>dfmat_lines</span></code></pre></div>
<pre><code>Document-feature matrix of: 909 documents, 1,168 features (99.73% sparse) and 0 docvars.
       features
docs    piping valleys wild songs pleasant glee cloud saw child laughing
  text1      1       1    1     0        0    0     0   0     0        0
  text2      1       0    0     1        1    1     0   0     0        0
  text3      0       0    0     0        0    0     1   1     1        0
  text4      0       0    0     0        0    0     0   0     0        1
  text5      0       0    0     0        0    0     0   0     0        0
  text6      0       0    0     0        0    0     0   0     0        0
[ reached max_ndoc ... 903 more documents, reached max_nfeat ... 1,158 more features ]</code></pre>
<ul>
<li>Create a separate document feature matrix treating each poem as a
document</li>
</ul>
<p>I first joined the lines of each poem so that each row will contain a
poem. After that, the same is done above here to get the dfm with each
poem as a document. Here, I did not trim anymore, and it gave 1168
features from the 47 documents with 95.85% sparse rate.</p>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>df_poems <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(book_title, poem_title, poem_number) <span class="sc">%&gt;%</span></span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">poem =</span> <span class="fu">str_c</span>(line, <span class="at">collapse=</span><span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>), <span class="at">.groups =</span> <span class="st">&#39;drop&#39;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(poem_number)</span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a>corp_poems <span class="ot">&lt;-</span> <span class="fu">corpus</span>(df_poems<span class="sc">$</span>poem)</span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a>dfmat_poems <span class="ot">&lt;-</span> corp_poems <span class="sc">%&gt;%</span> <span class="fu">tokens</span>(<span class="at">remove_punc=</span><span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tokens_remove</span>(<span class="at">pattern=</span><span class="fu">stopwords</span>(<span class="st">&quot;en&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb31-9"><a href="#cb31-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">dfm</span>()</span>
<span id="cb31-10"><a href="#cb31-10" aria-hidden="true" tabindex="-1"></a><span class="co">#  dfm_trim(min_termfreq=20)</span></span>
<span id="cb31-11"><a href="#cb31-11" aria-hidden="true" tabindex="-1"></a><span class="co">#  %&gt;% dfm_tfidf()</span></span>
<span id="cb31-12"><a href="#cb31-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-13"><a href="#cb31-13" aria-hidden="true" tabindex="-1"></a>dfmat_poems</span></code></pre></div>
<pre><code>Document-feature matrix of: 47 documents, 1,168 features (95.85% sparse) and 0 docvars.
       features
docs    piping valleys wild songs pleasant glee cloud saw child laughing
  text1      2       1    1     3        1    1     1   1     2        1
  text2      0       0    0     0        0    0     0   0     0        0
  text3      0       0    0     0        0    0     0   0     0        0
  text4      0       0    0     0        0    0     0   0     2        0
  text5      0       0    1     0        0    0     3   0     1        0
  text6      0       0    0     0        0    0     0   0     0        0
[ reached max_ndoc ... 41 more documents, reached max_nfeat ... 1,158 more features ]</code></pre>
<ul>
<li>Using one of these document feature matrices, create a plot that
compares the frequency of words in each book. Comment on the features
that are more or less frequent in one book than another.</li>
</ul>
<p>For easier and cleaner visualization, I used dfmat_poems into a dfm
with min_termfreq of 8 for Songs of Innocence (SOI), which gives me 19
documents with 27 features. For Songs of Experiences (SOE), I also used
min_termfreq of 8, which gives me 20 features from the 28 documents.
(Note: max_termfreq can also be used to trim the dfm if we want to
compare the least occuring words in each book.)</p>
<p>Comparing the two plots of document feature matrix, it can be seen
that the word “thee”, “little”, “sweet”, and “joy” are more frequently
used in the poems of SOI than in SOE. Meanwhile, words like “thy”,
“night”, and “sleep” have more occurrence in SOE than in SOI.</p>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>dfmat_soi <span class="ot">&lt;-</span> dfmat_poems[<span class="dv">1</span><span class="sc">:</span><span class="dv">19</span>,] <span class="sc">%&gt;%</span> <span class="fu">dfm_trim</span>(<span class="at">min_termfreq=</span><span class="dv">8</span>)</span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>dfmat_soi</span></code></pre></div>
<pre><code>Document-feature matrix of: 19 documents, 27 features (71.73% sparse) and 0 docvars.
       features
docs    child lamb merry hear thy happy joy sit thee sweet
  text1     2    1     1    3   3     3   2   1    1     0
  text2     0    0     0    0   0     0   0   0    0     2
  text3     0    0     2    0   0     1   0   0    0     0
  text4     2    8     0    0   1     0   0   0   12     0
  text5     1    0     0    1   0     0   3   0    0     0
  text6     0    0     2    0   0     2   0   0    0     0
[ reached max_ndoc ... 13 more documents, reached max_nfeat ... 17 more features ]</code></pre>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="co"># SOI - 1st to 19th poem</span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>tidy_dfm_soi <span class="ot">&lt;-</span> <span class="fu">melt</span>(<span class="fu">as.matrix</span>(dfmat_soi))</span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(tidy_dfm_soi, <span class="fu">aes</span>(<span class="fu">reorder</span>(features,<span class="sc">-</span>value), docs)) <span class="sc">+</span> </span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_tile</span>(<span class="fu">aes</span>(<span class="at">fill=</span>value), <span class="at">color=</span><span class="st">&quot;black&quot;</span>) <span class="sc">+</span> </span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label=</span>value)) <span class="sc">+</span> </span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_fixed</span>() <span class="sc">+</span> </span>
<span id="cb35-8"><a href="#cb35-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_distiller</span>(<span class="at">direction=</span><span class="dv">1</span>, <span class="at">palette=</span><span class="st">&quot;Greys&quot;</span>, <span class="at">limits=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">12</span>)) <span class="sc">+</span> </span>
<span id="cb35-9"><a href="#cb35-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_discrete</span>(<span class="at">position=</span><span class="st">&quot;top&quot;</span>) <span class="sc">+</span> </span>
<span id="cb35-10"><a href="#cb35-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle=</span><span class="dv">60</span>, <span class="at">vjust=</span><span class="fl">0.5</span>, <span class="at">hjust=</span><span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb35-11"><a href="#cb35-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;Frequency of Words&quot;</span>, </span>
<span id="cb35-12"><a href="#cb35-12" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;Documents/Poems&quot;</span>,</span>
<span id="cb35-13"><a href="#cb35-13" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">&quot;Songs of Innocence&quot;</span>)</span></code></pre></div>
<p><img
src="text_as_data_ps1_files/figure-html/unnamed-chunk-20-1.png" /><!-- --></p>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">&quot;./plots/dfmat_soi.png&quot;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>dfmat_soe <span class="ot">&lt;-</span> dfmat_poems[<span class="dv">20</span><span class="sc">:</span><span class="dv">47</span>,] <span class="sc">%&gt;%</span> <span class="fu">dfm_trim</span>(<span class="at">min_termfreq=</span><span class="dv">8</span>)</span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>dfmat_soe</span></code></pre></div>
<pre><code>Document-feature matrix of: 28 documents, 20 features (77.32% sparse) and 0 docvars.
        features
docs     thy every sweet day away little can delight bright mother
  text20   0     0     0   1    2      0   0       0      0      0
  text21   0     0     0   0    0      0   1       1      0      0
  text22   0     0     0   0    0      1   0       1      0      0
  text23   0     0     0   0    0      0   2       0      0      0
  text24   1     0     1   0    1      1   2       0      1      3
  text25   0     0     0   1    0      0   0       0      0      0
[ reached max_ndoc ... 22 more documents, reached max_nfeat ... 10 more features ]</code></pre>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="co"># SOE - 20th to 47th poem</span></span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>tidy_dfm_soe <span class="ot">&lt;-</span> <span class="fu">melt</span>(<span class="fu">as.matrix</span>(dfmat_soe))</span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(tidy_dfm_soe, <span class="fu">aes</span>(<span class="fu">reorder</span>(features,<span class="sc">-</span>value), docs)) <span class="sc">+</span> </span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_tile</span>(<span class="fu">aes</span>(<span class="at">fill=</span>value), <span class="at">color=</span><span class="st">&quot;black&quot;</span>) <span class="sc">+</span> </span>
<span id="cb39-6"><a href="#cb39-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label=</span>value)) <span class="sc">+</span> </span>
<span id="cb39-7"><a href="#cb39-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_fixed</span>() <span class="sc">+</span> </span>
<span id="cb39-8"><a href="#cb39-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_distiller</span>(<span class="at">direction=</span><span class="dv">1</span>, <span class="at">palette=</span><span class="st">&quot;Greys&quot;</span>, <span class="at">limits=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">8</span>)) <span class="sc">+</span> </span>
<span id="cb39-9"><a href="#cb39-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_discrete</span>(<span class="at">position=</span><span class="st">&quot;top&quot;</span>) <span class="sc">+</span> </span>
<span id="cb39-10"><a href="#cb39-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle=</span><span class="dv">60</span>, <span class="at">vjust=</span><span class="fl">0.5</span>, <span class="at">hjust=</span><span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb39-11"><a href="#cb39-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;Frequency of Words&quot;</span>, </span>
<span id="cb39-12"><a href="#cb39-12" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;Documents/Poems&quot;</span>,</span>
<span id="cb39-13"><a href="#cb39-13" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">&quot;Songs of Experience&quot;</span>)</span></code></pre></div>
<p><img
src="text_as_data_ps1_files/figure-html/unnamed-chunk-22-1.png" /><!-- --></p>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">&quot;./plots/dfmat_soe.png&quot;</span>)</span></code></pre></div>
</div>
</div>
<div id="iii.-parsing-xml-text-data" class="section level1">
<h1>III. Parsing XML text data</h1>
<p>I used the xml data from the Minutes of the 57th meeting on Thursday,
29 September 2022.</p>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="co"># parse XML data</span></span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">read_html</span>(<span class="st">&quot;https://www.bundestag.de/resource/blob/913074/a5fc2d586c98777a4550bda3f3740d77/20057-data.xml&quot;</span>)</span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a>speeches_xml <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span> <span class="fu">html_elements</span>(<span class="st">&quot;rede&quot;</span>)</span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a>speeches <span class="ot">&lt;-</span> <span class="fu">as_tibble</span>(<span class="fu">do.call</span>(rbind, <span class="fu">html_attrs</span>(speeches_xml)))</span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a>speeches<span class="sc">$</span>text <span class="ot">&lt;-</span> speeches_xml <span class="sc">%&gt;%</span> <span class="fu">html_text</span>()</span></code></pre></div>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="co"># extract politicians info</span></span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>politicians <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">id =</span> <span class="fu">character</span>(), <span class="at">name=</span><span class="fu">character</span>(), <span class="at">surname=</span><span class="fu">character</span>(), <span class="at">full_name=</span><span class="fu">character</span>(),</span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a>                      <span class="at">party=</span><span class="fu">character</span>(), <span class="at">role=</span><span class="fu">character</span>())</span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(speeches_xml)) {</span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a>  id <span class="ot">=</span> <span class="fu">xml_attr</span>(speeches_xml[i][[<span class="dv">1</span>]], <span class="st">&quot;id&quot;</span>)</span>
<span id="cb42-6"><a href="#cb42-6" aria-hidden="true" tabindex="-1"></a>  name <span class="ot">=</span> speeches_xml[i][[<span class="dv">1</span>]] <span class="sc">%&gt;%</span> <span class="fu">html_element</span>(<span class="st">&quot;vorname&quot;</span>) <span class="sc">%&gt;%</span> <span class="fu">html_text</span>()</span>
<span id="cb42-7"><a href="#cb42-7" aria-hidden="true" tabindex="-1"></a>  surname <span class="ot">=</span> speeches_xml[i][[<span class="dv">1</span>]] <span class="sc">%&gt;%</span> <span class="fu">html_element</span>(<span class="st">&quot;nachname&quot;</span>) <span class="sc">%&gt;%</span> <span class="fu">html_text</span>()</span>
<span id="cb42-8"><a href="#cb42-8" aria-hidden="true" tabindex="-1"></a>  full_name <span class="ot">=</span> <span class="fu">paste0</span>(name, <span class="st">&quot; &quot;</span>, surname)</span>
<span id="cb42-9"><a href="#cb42-9" aria-hidden="true" tabindex="-1"></a>  party <span class="ot">=</span> speeches_xml[i][[<span class="dv">1</span>]] <span class="sc">%&gt;%</span> <span class="fu">html_element</span>(<span class="st">&quot;fraktion&quot;</span>) <span class="sc">%&gt;%</span> <span class="fu">html_text</span>()</span>
<span id="cb42-10"><a href="#cb42-10" aria-hidden="true" tabindex="-1"></a>  role <span class="ot">=</span> speeches_xml[i][[<span class="dv">1</span>]] <span class="sc">%&gt;%</span> <span class="fu">html_element</span>(<span class="st">&quot;rolle&quot;</span>) <span class="sc">%&gt;%</span> <span class="fu">html_text</span>()</span>
<span id="cb42-11"><a href="#cb42-11" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb42-12"><a href="#cb42-12" aria-hidden="true" tabindex="-1"></a>  politicians <span class="ot">&lt;-</span> politicians <span class="sc">%&gt;%</span> <span class="fu">add_row</span>(<span class="at">id=</span>id, <span class="at">name=</span>name,<span class="at">surname=</span>surname,</span>
<span id="cb42-13"><a href="#cb42-13" aria-hidden="true" tabindex="-1"></a>                                         <span class="at">full_name=</span>full_name,<span class="at">party=</span>party,<span class="at">role=</span>role)</span>
<span id="cb42-14"><a href="#cb42-14" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb42-15"><a href="#cb42-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-16"><a href="#cb42-16" aria-hidden="true" tabindex="-1"></a><span class="co"># assuming the full names of the politicians are unique, assign unique id</span></span>
<span id="cb42-17"><a href="#cb42-17" aria-hidden="true" tabindex="-1"></a>politicians_df <span class="ot">&lt;-</span> politicians <span class="sc">%&gt;%</span> </span>
<span id="cb42-18"><a href="#cb42-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(full_name) <span class="sc">%&gt;%</span> </span>
<span id="cb42-19"><a href="#cb42-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">pol_id =</span> <span class="fu">cur_group_id</span>()) <span class="sc">%&gt;%</span> <span class="co"># 167 pol_ids</span></span>
<span id="cb42-20"><a href="#cb42-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(pol_id, id)</span></code></pre></div>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="co"># extract speeches only</span></span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>x<span class="ot">&lt;-</span>speeches<span class="sc">$</span>text[<span class="dv">1</span>]</span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a>a1<span class="ot">&lt;-</span>politicians[<span class="dv">1</span>,]<span class="sc">$</span>name</span>
<span id="cb43-5"><a href="#cb43-5" aria-hidden="true" tabindex="-1"></a>a2<span class="ot">&lt;-</span>politicians[<span class="dv">1</span>,]<span class="sc">$</span>full_name</span>
<span id="cb43-6"><a href="#cb43-6" aria-hidden="true" tabindex="-1"></a>a3<span class="ot">&lt;-</span>politicians[<span class="dv">1</span>,]<span class="sc">$</span>party</span>
<span id="cb43-7"><a href="#cb43-7" aria-hidden="true" tabindex="-1"></a>a4<span class="ot">&lt;-</span>politicians[<span class="dv">1</span>,]<span class="sc">$</span>role</span>
<span id="cb43-8"><a href="#cb43-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-9"><a href="#cb43-9" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">str_remove</span>(x, a3)</span></code></pre></div>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="co">#  compile data</span></span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a>speeches_df <span class="ot">&lt;-</span> <span class="fu">merge</span>(politicians_df, speeches, <span class="at">by =</span> <span class="st">&quot;id&quot;</span>)</span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a><span class="co"># save data</span></span>
<span id="cb44-5"><a href="#cb44-5" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(speeches_df, <span class="st">&quot;./data/tidy/session_minutes_290922.csv&quot;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">sprintf</span>(<span class="st">&quot;There are %s speeches delivered by %s politicians during the 57th meeting on Thursday, 29 September 2022&quot;</span>, <span class="fu">nrow</span>(speeches_df), <span class="fu">length</span>(<span class="fu">unique</span>(speeches_df<span class="sc">$</span>pol_id))))</span></code></pre></div>
<pre><code>[1] &quot;There are 194 speeches delivered by 167 politicians during the 57th meeting on Thursday, 29 September 2022&quot;</code></pre>
<p>I chose the politician named Alexander Radwan with pol_id == 3.
Below, I show the number of speeches and the content of the first
speech.</p>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a>pol_3 <span class="ot">&lt;-</span> speeches_df <span class="sc">%&gt;%</span> <span class="fu">filter</span>(pol_id<span class="sc">==</span><span class="dv">3</span>)</span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a>full_name <span class="ot">&lt;-</span> pol_3[<span class="dv">1</span>,]<span class="sc">$</span>full_name</span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">sprintf</span>(<span class="st">&quot;%s deliverd %s speeches during the 57th meeting on Thursday, 29 September 2022&quot;</span>, pol_3[<span class="dv">1</span>,]<span class="sc">$</span>full_name, <span class="fu">nrow</span>(pol_3)))</span></code></pre></div>
<pre><code>[1] &quot;Alexander Radwan deliverd 3 speeches during the 57th meeting on Thursday, 29 September 2022&quot;</code></pre>
<p>Below is the first speech that Alexander Radwan gave:</p>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="fu">writeLines</span>(pol_3[<span class="dv">1</span>,]<span class="sc">$</span>text)</span></code></pre></div>
<pre><code>
                    AlexanderRadwanCDU/CSUAlexander Radwan (CDU/CSU):
                Frau Präsidentin! Liebe Kolleginnen und Kollegen! Ich spreche jetzt hier nicht, weil ich in den zuständigen Ausschüssen bin, sondern weil ich wie der Kollege Otte als lokaler Abgeordneter mit dem Thema konfrontiert bin – aber jetzt nicht im Norden, sondern im Süden, dort, wo die Almen zu Hause sind. Dort ist schon seit sehr, sehr langer Zeit der Wolf ein großes Thema. Dort haben die Bauern schlicht und ergreifend das Gefühl, dass Teilen der deutschen Politik der Wolf wichtiger ist als ihre Höfe, als die Almen, als der Erhalt der kleinen Landwirtschaft.
                (Beifall bei der CDU/CSU sowie bei Abgeordneten der AfD)Das betrifft uns in Bayern bei den Almen, bei den Alpen, aber auch in Tirol. Und die Meldung, die ich die Tage aus Tirol bekommen habe, ist: 300 Tiere gerissen, über 1 500 Tiere frühzeitig abgetrieben. Weil die Bauern es satthaben und ihre Tiere nicht mehr sicher sind, führen sie diese runter, meine Damen und Herren.
                (Beifall bei der CDU/CSU)Gerade Almbauern arbeiten mit sehr viel Idealismus, mit sehr viel Leidenschaft auf ihren Almen, setzen sich dort ein; das ist sehr arbeitsintensiv. Und viele profitieren davon: Ausflügler, Wanderer, Mountainbiker.
                Vizepräsidentin Aydan Özoguz:Herr Kollege, gestatten Sie eine Zwischenfrage oder -bemerkung?
                
                    AlexanderRadwanCDU/CSUAlexander Radwan (CDU/CSU):
                Ich möchte das jetzt einfach mal zu Ende führen; ich habe ja eh nur drei Minuten.
                Vizepräsidentin Aydan Özoguz:Also: Nein.
                
                    AlexanderRadwanCDU/CSUAlexander Radwan (CDU/CSU):
                Besten Dank. – Dann ist es umso erstaunlicher, wenn bestimmte Ziele, die immer hochgehalten werden, wie Tierschutz oder das Ziel, dass die Anbindehaltung verhindert werden soll usw., dadurch konterkariert werden. Denn ein natürlicheres Leben wie auf der Alm gibt es für die Tiere nicht. Was ist Ihnen da wichtiger? Wollen Sie, dass die Bauern Stück für Stück aufhören? Was geschieht eigentlich mit der Artenvielfalt, wenn in kürzester Zeit die Almen wieder versteppen?
                (Zuruf des Abg. Dr. Jan-Niclas Gesenhues [BÜNDNIS 90/DIE GRÜNEN])Meine Damen und Herren, da sind Sie selber nicht konsistent in Ihrer Argumentation. Ihnen ist der Wolf wichtiger als all die anderen Argumente, die Sie regelmäßig anführen.
                (Beifall bei der CDU/CSU sowie bei Abgeordneten der AfD – Harald Ebner [BÜNDNIS 90/DIE GRÜNEN]: Komplexe Dinge sind einfach nicht so Ihrs!)Und der Höhepunkt war vor einem Jahr. Da haben sich die Bauern die Mühe gemacht, mal so einen Zaun hinzustellen. Da war dann ein Vertreter des BUND Naturschutz, und der hat bei seinem Grußwort gesagt: Ich bin dafür, dass es zwischen Almbauern und Wolf eine Koexistenz gibt. Wenn dieses aber nicht möglich ist, dann müssen die Almbauern – die seit Jahrhunderten ihre Almen haben – ihren Betrieb eben einstellen. – Das sagt dieser Mann diesen Menschen ins Gesicht, die alles daransetzen, unsere Kulturlandschaft entsprechend zu erhalten.
                (Beifall bei Abgeordneten der CDU/CSU und des Abg. Stephan Protschka [AfD])Meine Damen und Herren, in manchen Regionen ist eine Koexistenz nicht möglich. Da darf man nicht nur träumen, sondern da muss man der Realität ins Auge schauen. Man muss diese Menschen in ihren Sorgen ernst nehmen und schauen, dass die Almwirtschaft dort vorangeht, und darf nicht nur in Sonntagsreden oder bei Almbegehungen entsprechend das Hohelied singen, aber am Schluss die Menschen alleinlassen.
                Besten Dank, meine Damen und Herren.
                (Beifall bei der CDU/CSU sowie bei Abgeordneten der AfD – Dr. Anja Weisgerber [CDU/CSU]: Sehr gut! Hervorragend von Ihnen!)Vizepräsidentin Aydan Özoguz:Für eine Kurzintervention erhält das Wort der Kollege Lenkert von der Fraktion Die Linke.
            </code></pre>
</div>
<div id="iv.-using-regular-expressions" class="section level1">
<h1>IV. Using regular expressions</h1>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a>speech_id <span class="ot">&lt;-</span> <span class="fu">str_which</span>(speeches_df<span class="sc">$</span>text, <span class="at">pattern=</span><span class="st">&quot;</span><span class="sc">\\</span><span class="st">w*[Kk]ohle</span><span class="sc">\\</span><span class="st">w*&quot;</span>)</span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a>sum_id <span class="ot">&lt;-</span> <span class="fu">sum</span>(<span class="fu">str_detect</span>(speeches_df<span class="sc">$</span>text, <span class="at">pattern=</span><span class="st">&quot;</span><span class="sc">\\</span><span class="st">w*[Kk]ohle</span><span class="sc">\\</span><span class="st">w*&quot;</span>))</span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-5"><a href="#cb51-5" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">sprintf</span>(<span class="st">&quot;There are %s speeches that mentioned &#39;kohle&#39; during the 57th meeting on Thursday, 29 September 2022. Below is the list of the speech ids:&quot;</span>, sum_id))</span></code></pre></div>
<pre><code>[1] &quot;There are 11 speeches that mentioned &#39;kohle&#39; during the 57th meeting on Thursday, 29 September 2022. Below is the list of the speech ids:&quot;</code></pre>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a>speeches<span class="sc">$</span>id[speech_id]</span></code></pre></div>
<pre><code> [1] &quot;ID205700100&quot; &quot;ID205700300&quot; &quot;ID205701600&quot; &quot;ID205702000&quot; &quot;ID205703200&quot;
 [6] &quot;ID205705900&quot; &quot;ID205713300&quot; &quot;ID205713500&quot; &quot;ID205713700&quot; &quot;ID205714300&quot;
[11] &quot;ID205715900&quot;</code></pre>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a>kohle <span class="ot">&lt;-</span> <span class="fu">unlist</span>(<span class="fu">unique</span>((<span class="fu">str_extract_all</span>(speeches_df<span class="sc">$</span>text, <span class="at">pattern=</span><span class="st">&quot;</span><span class="sc">\\</span><span class="st">w*[Kk]ohle</span><span class="sc">\\</span><span class="st">w*&quot;</span>))))</span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a>kohle_tab <span class="ot">&lt;-</span> <span class="fu">as.tibble</span>(<span class="fu">table</span>(kohle)) <span class="sc">%&gt;%</span> <span class="fu">arrange</span>(<span class="fu">desc</span>(n))</span>
<span id="cb55-4"><a href="#cb55-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-5"><a href="#cb55-5" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">sprintf</span>(<span class="st">&quot;There are %s words that contain &#39;kohle&#39;.&quot;</span>, <span class="fu">nrow</span>(kohle_tab)))</span></code></pre></div>
<pre><code>[1] &quot;There are 7 words that contain &#39;kohle&#39;.&quot;</code></pre>
<div class="sourceCode" id="cb57"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a>kohle_tab</span></code></pre></div>
<div class="kable-table">
<table>
<thead>
<tr class="header">
<th align="left">kohle</th>
<th align="right">n</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Kohle</td>
<td align="right">4</td>
</tr>
<tr class="even">
<td align="left">Kohlekraftwerke</td>
<td align="right">2</td>
</tr>
<tr class="odd">
<td align="left">Kohleausstieg</td>
<td align="right">1</td>
</tr>
<tr class="even">
<td align="left">Kohlekraft</td>
<td align="right">1</td>
</tr>
<tr class="odd">
<td align="left">Kohlekraftwerken</td>
<td align="right">1</td>
</tr>
<tr class="even">
<td align="left">Kohlestrom</td>
<td align="right">1</td>
</tr>
<tr class="odd">
<td align="left">Kohleverstromung</td>
<td align="right">1</td>
</tr>
</tbody>
</table>
</div>
</div>



</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
